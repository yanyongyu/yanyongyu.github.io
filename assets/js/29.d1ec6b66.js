(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{383:function(s,a,t){"use strict";t.r(a);var e=t(0),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"天网管理系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#天网管理系统"}},[s._v("#")]),s._v(" 天网管理系统")]),s._v(" "),t("blockquote",[t("p",[s._v("来源： zusheng")]),s._v(" "),t("p",[s._v("难度：易")]),s._v(" "),t("p",[s._v("分值：10")]),s._v(" "),t("p",[s._v("参与人数：14678人")]),s._v(" "),t("p",[s._v("Get Flag：5210人")]),s._v(" "),t("p",[s._v("答题人数：5388人")]),s._v(" "),t("p",[s._v("解题通过率：97%")])]),s._v(" "),t("p",[s._v("天网你敢来挑战嘛")]),s._v(" "),t("p",[s._v("格式：ctf{}")]),s._v(" "),t("p",[s._v("解题链接： "),t("a",{attrs:{href:"http://ctf5.shiyanbar.com/10/web1/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://ctf5.shiyanbar.com/10/web1/"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"用户名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户名"}},[s._v("#")]),s._v(" 用户名")]),s._v(" "),t("p",[s._v("网页内容如图：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/%E5%AE%9E%E9%AA%8C%E5%90%A7-%E5%A4%A9%E7%BD%91%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/1.png",alt:"1"}})]),s._v(" "),t("p",[s._v("点击登录即POST请求了index.php，没有反应。查看源代码发现：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/%E5%AE%9E%E9%AA%8C%E5%90%A7-%E5%A4%A9%E7%BD%91%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/2.png",alt:"2"}})]),s._v(" "),t("p",[s._v("意思就是 "),t("code",[s._v("username")]),s._v(" 在经过md5之后要 "),t("code",[s._v("=='0'")]),s._v("。")]),s._v(" "),t("p",[s._v("在某些情况下，PHP会把类数值数据（如含有数字的字符串等）转换成数值处理，"),t("code",[s._v("==")]),s._v(" 运算符就是其中之一。在使用 "),t("code",[s._v("==")]),s._v(" 运算符对两个字符串进行松散比较时，"),t("strong",[s._v("PHP会把类数值的字符串转换为数值进行比较")]),s._v("，如果参数是字符串，则返回字符串中第一个不是数字的字符之前的数字串所代表的整数值。比如: "),t("code",[s._v("'3' == '3ascasd'")]),s._v(" 结果为 "),t("code",[s._v("true")]),s._v("。")]),s._v(" "),t("p",[s._v("因此只要找到一个字串加密后第一个字符为 "),t("code",[s._v("0")]),s._v(" 即可。这里提供几个："),t("code",[s._v("240610708")]),s._v("，"),t("code",[s._v("aabg7XSs")]),s._v("，"),t("code",[s._v("aabC9RqS")]),s._v("。")]),s._v(" "),t("p",[s._v("返回显示地址："),t("code",[s._v("/user.php?fame=hjkleffifer")]),s._v("。成功进入下一步。")]),s._v(" "),t("h3",{attrs:{id:"密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#密码"}},[s._v("#")]),s._v(" 密码")]),s._v(" "),t("p",[s._v("打开网址，显示一段话：")]),s._v(" "),t("blockquote",[t("p",[s._v("$unserialize_str = $_POST['password']; $data_unserialize = unserialize($unserialize_str); if($data_unserialize['user'] == '???' && $data_unserialize['pass']=='???') { print_r($flag); } 伟大的科学家php方言道：成也布尔，败也布尔。 回去吧骚年")])]),s._v(" "),t("p",[s._v("格式化一下代码：")]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$unserialize_str")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_POST")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'password'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$data_unserialize")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unserialize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$unserialize_str")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$data_unserialize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'user'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'???'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$data_unserialize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'pass'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'???'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("print_r")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$flag")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("意思就是 "),t("code",[s._v("password")]),s._v(" 字段反序列化之后得到一个对象，对象的 "),t("code",[s._v("user")]),s._v(" 等于一个值并且 "),t("code",[s._v("pass")]),s._v(" 等于一个值就可以拿到flag。")]),s._v(" "),t("p",[t("strong",[s._v("特别注意到bool类型的true跟任意字符串可以弱类型相等。")])]),s._v(" "),t("p",[s._v("构造password："),t("code",[s._v('a:2:{s:4:"user";b:1;s:4:"pass";b:1;}')]),s._v("。（a代表array，s代表string，b代表bool，而数字代表个数/长度）")]),s._v(" "),t("p",[s._v("成功拿到flag："),t("code",[s._v("ctf{dwduwkhduw5465}")])]),s._v(" "),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),t("p",[s._v("本题涉及到的主要知识点是php。包含php弱类型以及序列化。")])])}),[],!1,null,null,null);a.default=r.exports}}]);